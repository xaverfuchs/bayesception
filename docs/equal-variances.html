<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 2 Two-stimulus case with equal variances | bayesception – Documentation</title>
  <meta name="description" content="R implementations of Bayesian spatiotemporal perceptual integration" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 2 Two-stimulus case with equal variances | bayesception – Documentation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R implementations of Bayesian spatiotemporal perceptual integration" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 2 Two-stimulus case with equal variances | bayesception – Documentation" />
  
  <meta name="twitter:description" content="R implementations of Bayesian spatiotemporal perceptual integration" />
  

<meta name="author" content="Dr. Xaver Fuchs" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">bayesception</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this document</a></li>
<li class="chapter" data-level="2" data-path="equal-variances.html"><a href="equal-variances.html"><i class="fa fa-check"></i><b>2</b> Two-stimulus case with equal variances</a>
<ul>
<li class="chapter" data-level="2.1" data-path="equal-variances.html"><a href="equal-variances.html#background-information"><i class="fa fa-check"></i><b>2.1</b> Background information</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="equal-variances.html"><a href="equal-variances.html#hypotheses-derived-from-the-model"><i class="fa fa-check"></i><b>2.1.1</b> Hypotheses derived from the model</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="equal-variances.html"><a href="equal-variances.html#parameters"><i class="fa fa-check"></i><b>2.2</b> Parameters</a></li>
<li class="chapter" data-level="2.3" data-path="equal-variances.html"><a href="equal-variances.html#formula-for-prior-distribution"><i class="fa fa-check"></i><b>2.3</b> Formula for prior distribution</a></li>
<li class="chapter" data-level="2.4" data-path="equal-variances.html"><a href="equal-variances.html#formula-for-the-posterior-distribution"><i class="fa fa-check"></i><b>2.4</b> Formula for the posterior distribution</a></li>
<li class="chapter" data-level="2.5" data-path="equal-variances.html"><a href="equal-variances.html#r-implementations-of-the-formulae"><i class="fa fa-check"></i><b>2.5</b> R implementations of the formulae</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="equal-variances.html"><a href="equal-variances.html#prior-distribution"><i class="fa fa-check"></i><b>2.5.1</b> Prior distribution</a></li>
<li class="chapter" data-level="2.5.2" data-path="equal-variances.html"><a href="equal-variances.html#likelihood-distribution"><i class="fa fa-check"></i><b>2.5.2</b> Likelihood distribution</a></li>
<li class="chapter" data-level="2.5.3" data-path="equal-variances.html"><a href="equal-variances.html#posterior-distribution"><i class="fa fa-check"></i><b>2.5.3</b> Posterior distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="equal-variances.html"><a href="equal-variances.html#test-of-formulae"><i class="fa fa-check"></i><b>2.6</b> Test of formulae</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="equal-variances.html"><a href="equal-variances.html#used-model-parameters"><i class="fa fa-check"></i><b>2.6.1</b> Used model parameters</a></li>
<li class="chapter" data-level="2.6.2" data-path="equal-variances.html"><a href="equal-variances.html#compute-prior-likelihood-and-posterior"><i class="fa fa-check"></i><b>2.6.2</b> Compute Prior, Likelihood and Posterior</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="equal-variances.html"><a href="equal-variances.html#reproduce-figure-2"><i class="fa fa-check"></i><b>2.7</b> Reproduce Figure 2</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="equal-variances.html"><a href="equal-variances.html#numerical-sanity-check"><i class="fa fa-check"></i><b>2.7.1</b> Numerical sanity check</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="equal-variances.html"><a href="equal-variances.html#addressing-the-hypotheses"><i class="fa fa-check"></i><b>2.8</b> Addressing the hypotheses</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="equal-variances.html"><a href="equal-variances.html#stimuli-that-are-presented-far-apart-and-fast-will-be-perceptually-attracted-towards-each-other"><i class="fa fa-check"></i><b>2.8.1</b> Stimuli that are presented far apart and fast will be perceptually attracted towards each other</a></li>
<li class="chapter" data-level="2.8.2" data-path="equal-variances.html"><a href="equal-variances.html#the-faster-the-stimulation-the-stronger-is-the-length-contraction"><i class="fa fa-check"></i><b>2.8.2</b> The faster the stimulation, the stronger is the length contraction</a></li>
<li class="chapter" data-level="2.8.3" data-path="equal-variances.html"><a href="equal-variances.html#the-further-the-travelled-distance-the-stronger-the-length-contraction"><i class="fa fa-check"></i><b>2.8.3</b> The further the travelled distance, the stronger the length contraction</a></li>
<li class="chapter" data-level="2.8.4" data-path="equal-variances.html"><a href="equal-variances.html#the-higher-the-precision-the-weaker-the-length-contraction"><i class="fa fa-check"></i><b>2.8.4</b> The higher the precision, the weaker the length contraction</a></li>
<li class="chapter" data-level="2.8.5" data-path="equal-variances.html"><a href="equal-variances.html#the-stronger-the-low-velocity-prior-the-stronger-the-length-contraction"><i class="fa fa-check"></i><b>2.8.5</b> The stronger the low-velocity prior, the stronger the length contraction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">bayesception – Documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="equal-variances" class="section level1" number="2">
<h1><span class="header-section-number">Part 2</span> Two-stimulus case with equal variances</h1>
<div id="background-information" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Background information</h2>
<p>In this simple scenario, we consider two stimuli that are presented on the skin in two positions and are separated in time. Some basic assumptions of the Bayesian Observer Model are:</p>
<ol style="list-style-type: decimal">
<li>stimuli (on the skin) are never perceived with perfect accuracy because the precision is imperfect and therefore each stimulus perceived with a certain (random) measurement error</li>
<li>successive stimuli are caused by an object moving along the skin</li>
<li>objects move at a realistic speed. Or, in other words, it is unlikely that objects move very fast and that stimuli therefore move a far distance in a short time</li>
</ol>
<p>The second assumption is referred to as the low-velocity prior.</p>
<div id="hypotheses-derived-from-the-model" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Hypotheses derived from the model</h3>
<p>Some hypotheses that can be derived from the described model are:</p>
<ol style="list-style-type: decimal">
<li>stimuli that are presented far apart and fast will be perceptually attracted towards each other, i.e. there is a perceptual <em>length contraction</em></li>
<li>the faster the stimulation, the stronger is the length contraction</li>
<li>the further the traveled distance, the stronger the length contraction</li>
<li>the higher the precision, the weaker the length contraction</li>
<li>the stronger the low-velocity prior, the stronger the length contraction</li>
</ol>
</div>
</div>
<div id="parameters" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Parameters</h2>
<p>The model includes the following parameters:</p>
<ul>
<li><span class="math inline">\(x_{1m}\)</span> and <span class="math inline">\(x_{2m}\)</span> as the “measured” positions, i.e. the estimate given by the sensors corresponding to the stimulus positions</li>
<li><span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_1\)</span> as the inferred or hypothetical stimulus positions</li>
<li><span class="math inline">\(t\)</span> as the time (in seconds) passing between the taps</li>
<li><span class="math inline">\(\sigma_s\)</span> the spatial standard deviation, or uncertainty, referring to the sensed positions (<span class="math inline">\(x_{1m}\)</span> and <span class="math inline">\(x_{2m}\)</span>). Higher values indicate lower precision.</li>
<li><span class="math inline">\(\sigma_v\)</span> the degree of the “low-velocity.” Lower values indicate slower expected speed.</li>
</ul>
<p>A word about units:
Although the units of time and space are arbitrary as long as they are consistent, there is a consistent use of units in the literature.
Usually, all spatial units <span class="math inline">\(x_{1m}\)</span>, <span class="math inline">\(x_{2m}\)</span>, <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_1\)</span>, and <span class="math inline">\(\sigma_s\)</span> are expressed in cm units.
And time, <span class="math inline">\(t\)</span> is expressed as seconds.
The low-velocity prior <span class="math inline">\(\sigma_v\)</span> is expressed as space per time units and when using cm and seconds would be cm/s.
The <span class="math inline">\(\sigma_s\)</span> is sometimes conceptually referred to as the average localization error, e.g. with reference to The paper by Weinstein (1968) with 1 cm. Strictly speaking, however, it refers to the standard deviation, or variable error, of spatial localization.</p>
</div>
<div id="formula-for-prior-distribution" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Formula for prior distribution</h2>
<p>In the appendix, the formula for the prior distribution is given in
Formula A08 as:</p>
<p><span class="math display">\[p(x_1,x_2|t) \propto p(x_2|x_1,t) = \frac {1} {\sqrt{2\pi}\sigma_vt} exp(-\frac {(x_2-x_1)^2}{2(\sigma_v t)^2})\]</span>
## Formula for the likelihood distribution
The formula for the likelihood distribution is given in Formula A10 as:
<span class="math display">\[p(x_{1m},x_{2m}|x_1, x_2, t) = p(x_2|x_1,t) = p(x_{1m}|x_1)*p(x_{2m}|x_2)\]</span>
And these two conditional probabilities are defined in A11 as:
<span class="math display">\[p(x_{1m}|x_1) = \frac {1} {\sqrt{2\pi}\sigma_s} exp \left(-\frac {(x_{1m}-x_1)^2}{2\sigma_s^2} \right)\]</span>
and
<span class="math display">\[p(x_{2m}|x_2) = \frac {1} {\sqrt{2\pi}\sigma_s} exp \left(-\frac {(x_{2m}-x_2)^2}{2\sigma_s^2}\right)\]</span></p>
<p>Following logically from this, the likelihood computes as:
<span class="math display">\[p(x_{1m},x_{2m}|x_1, x_2, t) = \frac {1} {\sqrt{2\pi}\sigma_s} exp \left(-\frac {(x_{2m}-x_2)^2}{2\sigma_s^2}\right) * \frac {1} {\sqrt{2\pi}\sigma_s} exp \left(-\frac {(x_{2m}-x_2)^2}{2\sigma_s^2} \right)\]</span></p>
</div>
<div id="formula-for-the-posterior-distribution" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Formula for the posterior distribution</h2>
<p>The formula for the posterior distribution is given in A13 as:
<span class="math display">\[p(x_1, x_2|x_{1m},x_{2m}, t) \propto exp \left( - \left( \frac {(x_{1m} - x_1)^2 + (x_{2m} - x_2)^2} {2\sigma_s ^2} + \frac {(x_2-x_1)^2}{(2\sigma_v t)^2} \right) \right)\]</span></p>
<p>The formula for the posterior distribution is also formulated in in A14 as:</p>
<p><span class="math display">\[p(x_1, x_2|x_{1m},x_{2m}, t) \propto exp \left( -\frac {1} {2(1-\rho ^2)} \left( \frac {(x_1 - x_{1*})^2 + (x_2 - x_{2*})^2 - 2 \rho (x_1 - x_{1*}) (x_2 - x_{2*})} {\sigma ^2} \right) \right)\]</span>
However, some unknowns appear in this equation which are defined further down in A14.
The posterior modes, denoted as <span class="math inline">\(x_{1*}\)</span> and <span class="math inline">\(x_{2*}\)</span> are defined as:</p>
<p><span class="math display">\[x_{1*}=x_{1m} \left( \frac {(\sigma_v t)^2 + \sigma_s ^2} {(\sigma_v t)^2 + 2\sigma_s ^2} \right) + x_{2m} \left( \frac {\sigma_s^2} {(\sigma_v t)^2 + 2\sigma_s ^2} \right)\]</span>
and:
<span class="math display">\[x_{2*}=x_{2m} \left( \frac {(\sigma_v t)^2 + \sigma_s ^2} {(\sigma_v t)^2 + 2\sigma_s ^2} \right) + x_{1m} \left( \frac {\sigma_s^2} {(\sigma_v t)^2 + 2\sigma_s ^2} \right)\]</span></p>
<p>The correlation between the Gaussian distributions <span class="math inline">\(\rho\)</span> is given as:</p>
<p><span class="math display">\[\rho = \frac {\sigma_s^2} {\sigma_s^2 + (\sigma_v t)^2} \]</span>
Finally, the combined variance <span class="math inline">\(\sigma^2\)</span> is given as:</p>
<p><span class="math display">\[\sigma^2 =  \sigma_s^2 \frac {\sigma_s^2 + (\sigma_v t)^2} {2\sigma_s^2 + (\sigma_v t)^2}\]</span></p>
</div>
<div id="r-implementations-of-the-formulae" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> R implementations of the formulae</h2>
<p>The following code implements formula A08, A11 and A13, respectively.
The posterior and posterior modes can alternatively also be computed via formula A14.</p>
<p><strong>Note:</strong> the R functions preented below can also compute several values at a time, if the parameters are passed as vectors. You will see applications of that in the exaamples below.</p>
<div id="prior-distribution" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Prior distribution</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="equal-variances.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#formula A08</span></span>
<span id="cb2-2"><a href="equal-variances.html#cb2-2" aria-hidden="true" tabindex="-1"></a>computePrior <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2, sigma_v, time_t) {</span>
<span id="cb2-3"><a href="equal-variances.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  Prior <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>sigma_v<span class="sc">*</span>time_t) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(x2<span class="sc">-</span>x1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>(sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2-4"><a href="equal-variances.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Prior)</span>
<span id="cb2-5"><a href="equal-variances.html#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="likelihood-distribution" class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Likelihood distribution</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="equal-variances.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#formula A11</span></span>
<span id="cb3-2"><a href="equal-variances.html#cb3-2" aria-hidden="true" tabindex="-1"></a>computeLikelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(x1m, x2m, x1, x2, sigma_s) {</span>
<span id="cb3-3"><a href="equal-variances.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  p_x1m_given_x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>sigma_s) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(x1m<span class="sc">-</span>x1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-4"><a href="equal-variances.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  p_x2m_given_x2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>sigma_s) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(x2m<span class="sc">-</span>x2)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-5"><a href="equal-variances.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  Likelihood <span class="ot">&lt;-</span> p_x1m_given_x1<span class="sc">*</span>p_x2m_given_x2</span>
<span id="cb3-6"><a href="equal-variances.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Likelihood)</span>
<span id="cb3-7"><a href="equal-variances.html#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="posterior-distribution" class="section level3" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Posterior distribution</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="equal-variances.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#formula A13</span></span>
<span id="cb4-2"><a href="equal-variances.html#cb4-2" aria-hidden="true" tabindex="-1"></a>computePosterior <span class="ot">&lt;-</span> <span class="cf">function</span>(x1m, x2m, x1, x2, sigma_s, sigma_v, time_t) {</span>
<span id="cb4-3"><a href="equal-variances.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  Posterior <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>(((x1m<span class="sc">-</span>x1)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(x2m<span class="sc">-</span>x2)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (x2<span class="sc">-</span>x1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>(sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb4-4"><a href="equal-variances.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Posterior)</span>
<span id="cb4-5"><a href="equal-variances.html#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="equal-variances.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#formula A14</span></span>
<span id="cb5-2"><a href="equal-variances.html#cb5-2" aria-hidden="true" tabindex="-1"></a>compute_x1_star <span class="ot">&lt;-</span> <span class="cf">function</span>(x1m, x2m, sigma_s, sigma_v, time_t) {</span>
<span id="cb5-3"><a href="equal-variances.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  x1_star <span class="ot">&lt;-</span> x1m <span class="sc">*</span> (((sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>sigma_s<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> ((sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span> x2m <span class="sc">*</span> (sigma_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> ((sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb5-4"><a href="equal-variances.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="equal-variances.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x1_star)</span>
<span id="cb5-6"><a href="equal-variances.html#cb5-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-7"><a href="equal-variances.html#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="equal-variances.html#cb5-8" aria-hidden="true" tabindex="-1"></a>compute_x2_star <span class="ot">&lt;-</span> <span class="cf">function</span>(x1m, x2m, sigma_s, sigma_v, time_t) {</span>
<span id="cb5-9"><a href="equal-variances.html#cb5-9" aria-hidden="true" tabindex="-1"></a>  x2_star <span class="ot">&lt;-</span> x1m <span class="sc">*</span> (sigma_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> ((sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span> x2m <span class="sc">*</span> (((sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>sigma_s<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> ((sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb5-10"><a href="equal-variances.html#cb5-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-11"><a href="equal-variances.html#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x2_star)</span>
<span id="cb5-12"><a href="equal-variances.html#cb5-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-13"><a href="equal-variances.html#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="equal-variances.html#cb5-14" aria-hidden="true" tabindex="-1"></a>compute_common_sigma_square <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma_s, sigma_v, time_t) {</span>
<span id="cb5-15"><a href="equal-variances.html#cb5-15" aria-hidden="true" tabindex="-1"></a>  sigma_square <span class="ot">&lt;-</span> sigma_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (sigma_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-16"><a href="equal-variances.html#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sigma_square)</span>
<span id="cb5-17"><a href="equal-variances.html#cb5-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="equal-variances.html#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="equal-variances.html#cb5-19" aria-hidden="true" tabindex="-1"></a>compute_correlation <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma_s, sigma_v, time_t) {</span>
<span id="cb5-20"><a href="equal-variances.html#cb5-20" aria-hidden="true" tabindex="-1"></a>  distr_correlation <span class="ot">&lt;-</span> sigma_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (sigma_s<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (sigma_v<span class="sc">*</span>time_t)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-21"><a href="equal-variances.html#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(distr_correlation)</span>
<span id="cb5-22"><a href="equal-variances.html#cb5-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-23"><a href="equal-variances.html#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="equal-variances.html#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="equal-variances.html#cb5-25" aria-hidden="true" tabindex="-1"></a>computePosterior2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x1m, x2m, x1, x2, sigma_s, sigma_v, time_t, <span class="at">returnList=</span>F) {</span>
<span id="cb5-26"><a href="equal-variances.html#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#first compute the necessary variables</span></span>
<span id="cb5-27"><a href="equal-variances.html#cb5-27" aria-hidden="true" tabindex="-1"></a>  x1_star <span class="ot">&lt;-</span> <span class="fu">compute_x1_star</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m, <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb5-28"><a href="equal-variances.html#cb5-28" aria-hidden="true" tabindex="-1"></a>  x2_star <span class="ot">&lt;-</span> <span class="fu">compute_x2_star</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m, <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb5-29"><a href="equal-variances.html#cb5-29" aria-hidden="true" tabindex="-1"></a>  common_sigma_square <span class="ot">&lt;-</span> <span class="fu">compute_common_sigma_square</span>(<span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb5-30"><a href="equal-variances.html#cb5-30" aria-hidden="true" tabindex="-1"></a>  correlation <span class="ot">&lt;-</span> <span class="fu">compute_correlation</span> (<span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb5-31"><a href="equal-variances.html#cb5-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-32"><a href="equal-variances.html#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now use formula 14 to compute posterior </span></span>
<span id="cb5-33"><a href="equal-variances.html#cb5-33" aria-hidden="true" tabindex="-1"></a>  Posterior <span class="ot">&lt;-</span> <span class="fu">exp</span>(  ( <span class="sc">-</span>  <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>correlation<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> </span>
<span id="cb5-34"><a href="equal-variances.html#cb5-34" aria-hidden="true" tabindex="-1"></a>                           ( ((x1<span class="sc">-</span>x1_star)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (x2<span class="sc">-</span>x2_star)<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>correlation <span class="sc">*</span> </span>
<span id="cb5-35"><a href="equal-variances.html#cb5-35" aria-hidden="true" tabindex="-1"></a>                               (x1<span class="sc">-</span>x1_star)<span class="sc">*</span>(x2<span class="sc">-</span>x2_star) )<span class="sc">/</span>common_sigma_square ) )</span>
<span id="cb5-36"><a href="equal-variances.html#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (returnList<span class="sc">==</span>T) {</span>
<span id="cb5-37"><a href="equal-variances.html#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#extend to be a list</span></span>
<span id="cb5-38"><a href="equal-variances.html#cb5-38" aria-hidden="true" tabindex="-1"></a>    returnList <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x1_star=</span> x1_star, <span class="at">x2_star=</span>x2_star, </span>
<span id="cb5-39"><a href="equal-variances.html#cb5-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">common_sigma_square=</span>common_sigma_square, <span class="at">correlation=</span>correlation, </span>
<span id="cb5-40"><a href="equal-variances.html#cb5-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Posterior =</span> Posterior )</span>
<span id="cb5-41"><a href="equal-variances.html#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(returnList)</span>
<span id="cb5-42"><a href="equal-variances.html#cb5-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-43"><a href="equal-variances.html#cb5-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-44"><a href="equal-variances.html#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Posterior)</span>
<span id="cb5-45"><a href="equal-variances.html#cb5-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-46"><a href="equal-variances.html#cb5-46" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="test-of-formulae" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Test of formulae</h2>
<p>The following code will test the formulae to evaluate whether the output makes sense.</p>
<div id="used-model-parameters" class="section level3" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Used model parameters</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="equal-variances.html#cb6-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb6-2"><a href="equal-variances.html#cb6-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb6-3"><a href="equal-variances.html#cb6-3" aria-hidden="true" tabindex="-1"></a>x1m <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb6-4"><a href="equal-variances.html#cb6-4" aria-hidden="true" tabindex="-1"></a>x2m <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb6-5"><a href="equal-variances.html#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="equal-variances.html#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="equal-variances.html#cb6-7" aria-hidden="true" tabindex="-1"></a>sigma_s <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#spatial resolution as used for Figure 2</span></span>
<span id="cb6-8"><a href="equal-variances.html#cb6-8" aria-hidden="true" tabindex="-1"></a>sigma_v <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#low speed prior</span></span>
<span id="cb6-9"><a href="equal-variances.html#cb6-9" aria-hidden="true" tabindex="-1"></a>time_t <span class="ot">&lt;-</span> <span class="fl">0.15</span> <span class="co">#seconds passing between taps</span></span></code></pre></div>
</div>
<div id="compute-prior-likelihood-and-posterior" class="section level3" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Compute Prior, Likelihood and Posterior</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="equal-variances.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#single point values</span></span>
<span id="cb7-2"><a href="equal-variances.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">computePrior</span>(<span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t) </span></code></pre></div>
<pre><code>## [1] 0.007597324</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="equal-variances.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">computeLikelihood</span>(<span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, <span class="at">x1m =</span> x1, <span class="at">x2m =</span> x2, <span class="at">sigma_s =</span> sigma_s)</span></code></pre></div>
<pre><code>## [1] 0.1591549</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="equal-variances.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">computePosterior</span>(<span class="at">x1m =</span> x1, <span class="at">x2m =</span> x2, <span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span></code></pre></div>
<pre><code>## [1] 0.0285655</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="equal-variances.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#and the alternative version</span></span>
<span id="cb13-2"><a href="equal-variances.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">computePosterior2</span>(<span class="at">x1m =</span> x1, <span class="at">x2m =</span> x2, <span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, </span>
<span id="cb13-3"><a href="equal-variances.html#cb13-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t, <span class="at">returnList=</span>T)</span></code></pre></div>
<pre><code>## $x1_star
## [1] 3.941176
## 
## $x2_star
## [1] 6.058824
## 
## $common_sigma_square
## [1] 0.7647059
## 
## $correlation
## [1] 0.3076923
## 
## $Posterior
## [1] 0.1876451</code></pre>
<p>Note that the absolute values derived from the functions “computePosterior” (based on formula A13) and “computePosterior2” (based on A14) are not identical. In the end, however, it does not matter because the probabilities themselves are not valid anyway because it the given sign is “proportional to” <span class="math inline">\(\propto\)</span>.
Note in the plot in the next section that the distributions themselves would be identical when they are normalized (transformed so that the sum of all values equals 1).</p>
</div>
</div>
<div id="reproduce-figure-2" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Reproduce Figure 2</h2>
<p>In the following, we reproduce Figure 2 from <span class="citation">(<a href="references.html#ref-goldreich_prediction_2013" role="doc-biblioref">Goldreich and Tong 2013</a>)</span>.
The following parameters are used in the article and are used here for plotting.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="equal-variances.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#params for plots</span></span>
<span id="cb15-2"><a href="equal-variances.html#cb15-2" aria-hidden="true" tabindex="-1"></a>x1_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb15-3"><a href="equal-variances.html#cb15-3" aria-hidden="true" tabindex="-1"></a>x2_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb15-4"><a href="equal-variances.html#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="equal-variances.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#resolution for graphs</span></span>
<span id="cb15-6"><a href="equal-variances.html#cb15-6" aria-hidden="true" tabindex="-1"></a>x1_res <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb15-7"><a href="equal-variances.html#cb15-7" aria-hidden="true" tabindex="-1"></a>x2_res <span class="ot">&lt;-</span> <span class="dv">100</span></span></code></pre></div>
<p>Compute the values fot the whole matrix</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="equal-variances.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prior</span></span>
<span id="cb16-2"><a href="equal-variances.html#cb16-2" aria-hidden="true" tabindex="-1"></a>priorMat <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1=</span><span class="fu">seq</span>(x1_range[<span class="dv">1</span>], x1_range[<span class="dv">2</span>], <span class="at">length.out =</span> x1_res),</span>
<span id="cb16-3"><a href="equal-variances.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x2=</span><span class="fu">seq</span>(x2_range[<span class="dv">1</span>], x2_range[<span class="dv">2</span>], <span class="at">length.out =</span> x2_res))</span>
<span id="cb16-4"><a href="equal-variances.html#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="equal-variances.html#cb16-5" aria-hidden="true" tabindex="-1"></a>priorMat<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">computePrior</span>(<span class="at">x1 =</span> priorMat<span class="sc">$</span>x1, <span class="at">x2 =</span> priorMat<span class="sc">$</span>x2, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb16-6"><a href="equal-variances.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="equal-variances.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#likelihood</span></span>
<span id="cb16-8"><a href="equal-variances.html#cb16-8" aria-hidden="true" tabindex="-1"></a>likelihoodMat <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1=</span><span class="fu">seq</span>(x1_range[<span class="dv">1</span>], x1_range[<span class="dv">2</span>], <span class="at">length.out =</span> x1_res),</span>
<span id="cb16-9"><a href="equal-variances.html#cb16-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x2=</span><span class="fu">seq</span>(x2_range[<span class="dv">1</span>], x2_range[<span class="dv">2</span>], <span class="at">length.out =</span> x2_res))</span>
<span id="cb16-10"><a href="equal-variances.html#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="equal-variances.html#cb16-11" aria-hidden="true" tabindex="-1"></a>likelihoodMat<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">computeLikelihood</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m, </span>
<span id="cb16-12"><a href="equal-variances.html#cb16-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">x1 =</span> likelihoodMat<span class="sc">$</span>x1, <span class="at">x2 =</span> likelihoodMat<span class="sc">$</span>x2, <span class="at">sigma_s =</span> sigma_s)</span>
<span id="cb16-13"><a href="equal-variances.html#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="equal-variances.html#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#posterior</span></span>
<span id="cb16-15"><a href="equal-variances.html#cb16-15" aria-hidden="true" tabindex="-1"></a>posteriorMat <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1=</span><span class="fu">seq</span>(x1_range[<span class="dv">1</span>], x1_range[<span class="dv">2</span>], <span class="at">length.out =</span> x1_res),</span>
<span id="cb16-16"><a href="equal-variances.html#cb16-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x2=</span><span class="fu">seq</span>(x2_range[<span class="dv">1</span>], x2_range[<span class="dv">2</span>], <span class="at">length.out =</span> x2_res))</span>
<span id="cb16-17"><a href="equal-variances.html#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="equal-variances.html#cb16-18" aria-hidden="true" tabindex="-1"></a>posteriorMat<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">computePosterior</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m,</span>
<span id="cb16-19"><a href="equal-variances.html#cb16-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x1 =</span> posteriorMat<span class="sc">$</span>x1, <span class="at">x2 =</span> posteriorMat<span class="sc">$</span>x2, </span>
<span id="cb16-20"><a href="equal-variances.html#cb16-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb16-21"><a href="equal-variances.html#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="equal-variances.html#cb16-22" aria-hidden="true" tabindex="-1"></a>posteriorMat<span class="sc">$</span>p2 <span class="ot">&lt;-</span> <span class="fu">computePosterior2</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m,</span>
<span id="cb16-23"><a href="equal-variances.html#cb16-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x1 =</span> posteriorMat<span class="sc">$</span>x1, <span class="at">x2 =</span> posteriorMat<span class="sc">$</span>x2, </span>
<span id="cb16-24"><a href="equal-variances.html#cb16-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span></code></pre></div>
<p>Now create a plot of all three distributions (like in Figure 2). We add a fourth one to demonstrate that both formulae for the posterior distribution lead to similar distributions.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="equal-variances.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prior</span></span>
<span id="cb17-2"><a href="equal-variances.html#cb17-2" aria-hidden="true" tabindex="-1"></a>prior.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(priorMat, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2, <span class="at">fill=</span>p)) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="equal-variances.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span> </span>
<span id="cb17-4"><a href="equal-variances.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb17-5"><a href="equal-variances.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;prior&quot;</span>)</span>
<span id="cb17-6"><a href="equal-variances.html#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="equal-variances.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#likelihood</span></span>
<span id="cb17-8"><a href="equal-variances.html#cb17-8" aria-hidden="true" tabindex="-1"></a>likelihood.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(likelihoodMat, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2, <span class="at">fill=</span>p)) <span class="sc">+</span> </span>
<span id="cb17-9"><a href="equal-variances.html#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span> </span>
<span id="cb17-10"><a href="equal-variances.html#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb17-11"><a href="equal-variances.html#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;likelihood&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="equal-variances.html#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2, <span class="at">size=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="cn">NA</span>) <span class="co">#real position</span></span>
<span id="cb17-13"><a href="equal-variances.html#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="equal-variances.html#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#posterior</span></span>
<span id="cb17-15"><a href="equal-variances.html#cb17-15" aria-hidden="true" tabindex="-1"></a>Posterior_mode_x1 <span class="ot">&lt;-</span> <span class="fu">compute_x1_star</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m, </span>
<span id="cb17-16"><a href="equal-variances.html#cb17-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb17-17"><a href="equal-variances.html#cb17-17" aria-hidden="true" tabindex="-1"></a>Posterior_mode_x2 <span class="ot">&lt;-</span> <span class="fu">compute_x2_star</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m, </span>
<span id="cb17-18"><a href="equal-variances.html#cb17-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb17-19"><a href="equal-variances.html#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="equal-variances.html#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#version based on A13</span></span>
<span id="cb17-21"><a href="equal-variances.html#cb17-21" aria-hidden="true" tabindex="-1"></a>posterior.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posteriorMat, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2, <span class="at">fill=</span>p)) <span class="sc">+</span> </span>
<span id="cb17-22"><a href="equal-variances.html#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span> </span>
<span id="cb17-23"><a href="equal-variances.html#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb17-24"><a href="equal-variances.html#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;posterior&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-25"><a href="equal-variances.html#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2, <span class="at">size=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="cn">NA</span>) <span class="sc">+</span> <span class="co">#real position </span></span>
<span id="cb17-26"><a href="equal-variances.html#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x=</span>Posterior_mode_x1 , <span class="at">y=</span>Posterior_mode_x2, <span class="at">size=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="cn">NA</span>) <span class="co">#posterior mode</span></span>
<span id="cb17-27"><a href="equal-variances.html#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="equal-variances.html#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">#version based on A14</span></span>
<span id="cb17-29"><a href="equal-variances.html#cb17-29" aria-hidden="true" tabindex="-1"></a>posterior.plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posteriorMat, <span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2, <span class="at">fill=</span>p2)) <span class="sc">+</span> </span>
<span id="cb17-30"><a href="equal-variances.html#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span> </span>
<span id="cb17-31"><a href="equal-variances.html#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb17-32"><a href="equal-variances.html#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;posterior2&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-33"><a href="equal-variances.html#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x=</span>x1, <span class="at">y=</span>x2, <span class="at">size=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="cn">NA</span>) <span class="sc">+</span> <span class="co">#real position </span></span>
<span id="cb17-34"><a href="equal-variances.html#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x=</span>Posterior_mode_x1 , <span class="at">y=</span>Posterior_mode_x2, <span class="at">size=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="cn">NA</span>) <span class="co">#posterior mode</span></span>
<span id="cb17-35"><a href="equal-variances.html#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="equal-variances.html#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="equal-variances.html#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co">#create a panel</span></span>
<span id="cb17-38"><a href="equal-variances.html#cb17-38" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(prior.plot, likelihood.plot, posterior.plot, posterior.plot2)</span></code></pre></div>
<div class="figure"><span id="fig:fig-all-distributions"></span>
<img src="bayesception_files/figure-html/fig-all-distributions-1.png" alt="prior, likelihood, and posterior distributions" width="672" />
<p class="caption">
Figure 2.1: prior, likelihood, and posterior distributions
</p>
</div>
<p>The figure looks just like in the article.</p>
<div id="numerical-sanity-check" class="section level3" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Numerical sanity check</h3>
<p>As a quick sanity check: compare the analytically dtermined posterior mode to the one that can be seen in the figure. This can simply be done by finding the value with the highest posterior probability numerically and chhecking where it is.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="equal-variances.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Posterior mode determined analytically</span></span>
<span id="cb18-2"><a href="equal-variances.html#cb18-2" aria-hidden="true" tabindex="-1"></a>Posterior_mode_x1 <span class="ot">&lt;-</span> <span class="fu">compute_x1_star</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m, </span>
<span id="cb18-3"><a href="equal-variances.html#cb18-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb18-4"><a href="equal-variances.html#cb18-4" aria-hidden="true" tabindex="-1"></a>Posterior_mode_x2 <span class="ot">&lt;-</span> <span class="fu">compute_x2_star</span>(<span class="at">x1m =</span> x1m, <span class="at">x2m =</span> x2m, </span>
<span id="cb18-5"><a href="equal-variances.html#cb18-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sigma_s =</span> sigma_s, <span class="at">sigma_v =</span> sigma_v, <span class="at">time_t =</span> time_t)</span>
<span id="cb18-6"><a href="equal-variances.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="equal-variances.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;analytical values for x1:&quot;</span>, </span>
<span id="cb18-8"><a href="equal-variances.html#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(Posterior_mode_x1, <span class="dv">3</span>),</span>
<span id="cb18-9"><a href="equal-variances.html#cb18-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> and for x2:&quot;</span>, </span>
<span id="cb18-10"><a href="equal-variances.html#cb18-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(Posterior_mode_x2, <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;analytical values for x1: 3.941 \n and for x2: 6.059&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="equal-variances.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Posterior mode determined numerically</span></span>
<span id="cb20-2"><a href="equal-variances.html#cb20-2" aria-hidden="true" tabindex="-1"></a>posteriorMax <span class="ot">&lt;-</span> <span class="fu">max</span>(posteriorMat<span class="sc">$</span>p)</span>
<span id="cb20-3"><a href="equal-variances.html#cb20-3" aria-hidden="true" tabindex="-1"></a>posteriorMax.index <span class="ot">&lt;-</span> <span class="fu">which</span>(posteriorMat<span class="sc">$</span>p<span class="sc">==</span>posteriorMax)</span>
<span id="cb20-4"><a href="equal-variances.html#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="equal-variances.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;numerical values for x1:&quot;</span>, </span>
<span id="cb20-6"><a href="equal-variances.html#cb20-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(posteriorMat<span class="sc">$</span>x1[posteriorMax.index], <span class="dv">3</span>),</span>
<span id="cb20-7"><a href="equal-variances.html#cb20-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> and for x2:&quot;</span>, </span>
<span id="cb20-8"><a href="equal-variances.html#cb20-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(posteriorMat<span class="sc">$</span>x2[posteriorMax.index], <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;numerical values for x1: 3.939 \n and for x2: 6.061&quot;</code></pre>
<p>We can see that the values match quite well.</p>
</div>
</div>
<div id="addressing-the-hypotheses" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Addressing the hypotheses</h2>
<p>In this section we will evaluate the hypotheses mentioned above by varying model parameters.</p>
<div id="stimuli-that-are-presented-far-apart-and-fast-will-be-perceptually-attracted-towards-each-other" class="section level3" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Stimuli that are presented far apart and fast will be perceptually attracted towards each other</h3>
<p>This hypothesis is inherently confirmed in the computations above: note that the veridical stimuli were presented at positions of 3 and 7 cm, respectively. This is a distance of 4 cm. The posterior modes were at about 3.9 and 6.1 cm. This is only a distance of 2.2 cm. The model accordingly predicts a length contraction of 4 - 2.2 = 1.8 cm for this set of parameters.</p>
</div>
<div id="the-faster-the-stimulation-the-stronger-is-the-length-contraction" class="section level3" number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> The faster the stimulation, the stronger is the length contraction</h3>
<p>To address this point, we repeat the model estimations for different values of <span class="math inline">\(t\)</span>, the time passing between the two taps.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="equal-variances.html#cb22-1" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1m=</span><span class="dv">3</span>, <span class="at">x2m=</span><span class="dv">7</span>, <span class="at">sigma_s=</span><span class="dv">1</span>, <span class="at">sigma_v=</span><span class="dv">10</span>, <span class="at">time_t=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">length.out=</span><span class="dv">21</span>))</span>
<span id="cb22-2"><a href="equal-variances.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="equal-variances.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute posterior modes</span></span>
<span id="cb22-4"><a href="equal-variances.html#cb22-4" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x1 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x1_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb22-5"><a href="equal-variances.html#cb22-5" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x2 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x2_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb22-6"><a href="equal-variances.html#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="equal-variances.html#cb22-7" aria-hidden="true" tabindex="-1"></a>modelData <span class="sc">%&gt;%</span> </span>
<span id="cb22-8"><a href="equal-variances.html#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pm_x1, pm_x2), <span class="at">names_to =</span> <span class="st">&quot;posterior&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;position&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="equal-variances.html#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>time_t, <span class="at">y=</span>position, <span class="at">color=</span>posterior)) <span class="sc">+</span> </span>
<span id="cb22-10"><a href="equal-variances.html#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">7</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb22-11"><a href="equal-variances.html#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="equal-variances.html#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb22-13"><a href="equal-variances.html#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() </span></code></pre></div>
<div class="figure"><span id="fig:fig-speed-and-contraction"></span>
<img src="bayesception_files/figure-html/fig-speed-and-contraction-1.png" alt="stronger contraction at shorter time t" width="672" />
<p class="caption">
Figure 2.2: stronger contraction at shorter time t
</p>
</div>
<p>As can be seen from the figure, the attraction of the stimuli towards each other and the according length contraction is strong for short time intervals between the stimuli and disappears for delays of one second or more.</p>
</div>
<div id="the-further-the-travelled-distance-the-stronger-the-length-contraction" class="section level3" number="2.8.3">
<h3><span class="header-section-number">2.8.3</span> The further the travelled distance, the stronger the length contraction</h3>
<p>To show predictions for this scenario, we keep t and sigma_s constant and vary the positions of the taps.
Note that due to the small scale, we have decreased the sigma_s parameter to 0.1 to emphasize the effect.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="equal-variances.html#cb23-1" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1m=</span><span class="dv">0</span>, <span class="at">x2m=</span><span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out=</span><span class="dv">10</span>), <span class="at">sigma_s=</span><span class="fl">0.1</span>, <span class="at">sigma_v=</span><span class="dv">10</span>, <span class="at">time_t=</span><span class="fl">0.015</span>)</span>
<span id="cb23-2"><a href="equal-variances.html#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="equal-variances.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute posterior modes</span></span>
<span id="cb23-4"><a href="equal-variances.html#cb23-4" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x1 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x1_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb23-5"><a href="equal-variances.html#cb23-5" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x2 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x2_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb23-6"><a href="equal-variances.html#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="equal-variances.html#cb23-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> modelData <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="equal-variances.html#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pm_x1, pm_x2), <span class="at">names_to =</span> <span class="st">&quot;posterior&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;position&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-9"><a href="equal-variances.html#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x2m, <span class="at">y=</span>position, <span class="at">color=</span>posterior)) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="equal-variances.html#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-11"><a href="equal-variances.html#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb23-12"><a href="equal-variances.html#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="equal-variances.html#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb23-14"><a href="equal-variances.html#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb23-15"><a href="equal-variances.html#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;posterior modes for </span><span class="sc">\n</span><span class="st">varying veridical distances&quot;</span>)</span>
<span id="cb23-16"><a href="equal-variances.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-17"><a href="equal-variances.html#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="equal-variances.html#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co">#and another plot of the real distance vs. perceived distance  </span></span>
<span id="cb23-19"><a href="equal-variances.html#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="do">##compute real and perceived distances</span></span>
<span id="cb23-20"><a href="equal-variances.html#cb23-20" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> modelData <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">veridical=</span>x2m<span class="sc">-</span>x1m, <span class="at">perceived=</span>pm_x2<span class="sc">-</span>pm_x1)</span>
<span id="cb23-21"><a href="equal-variances.html#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="equal-variances.html#cb23-22" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> modelData <span class="sc">%&gt;%</span> </span>
<span id="cb23-23"><a href="equal-variances.html#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>veridical, <span class="at">y=</span>perceived)) <span class="sc">+</span> </span>
<span id="cb23-24"><a href="equal-variances.html#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb23-25"><a href="equal-variances.html#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-26"><a href="equal-variances.html#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb23-27"><a href="equal-variances.html#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb23-28"><a href="equal-variances.html#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;veridical vs. perceived </span><span class="sc">\n</span><span class="st">distances&quot;</span>)</span>
<span id="cb23-29"><a href="equal-variances.html#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="equal-variances.html#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co">#merge plots</span></span>
<span id="cb23-31"><a href="equal-variances.html#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.75</span>))</span></code></pre></div>
<div class="figure"><span id="fig:fig-varying-distance-and-contraction"></span>
<img src="bayesception_files/figure-html/fig-varying-distance-and-contraction-1.png" alt="stronger (relative) contraction for larger distances" width="672" />
<p class="caption">
Figure 2.3: stronger (relative) contraction for larger distances
</p>
</div>
</div>
<div id="the-higher-the-precision-the-weaker-the-length-contraction" class="section level3" number="2.8.4">
<h3><span class="header-section-number">2.8.4</span> The higher the precision, the weaker the length contraction</h3>
<p>This time we keep parameters all parameters constant except for the sigma_s.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="equal-variances.html#cb24-1" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1m=</span><span class="dv">3</span>, <span class="at">x2m=</span><span class="dv">7</span>, <span class="at">sigma_s=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">length.out=</span><span class="dv">21</span>), <span class="at">sigma_v=</span><span class="dv">10</span>, <span class="at">time_t=</span><span class="fl">0.15</span>)</span>
<span id="cb24-2"><a href="equal-variances.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="equal-variances.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute posterior modes</span></span>
<span id="cb24-4"><a href="equal-variances.html#cb24-4" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x1 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x1_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb24-5"><a href="equal-variances.html#cb24-5" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x2 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x2_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb24-6"><a href="equal-variances.html#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="equal-variances.html#cb24-7" aria-hidden="true" tabindex="-1"></a>modelData <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="equal-variances.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pm_x1, pm_x2), <span class="at">names_to =</span> <span class="st">&quot;posterior&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;position&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-9"><a href="equal-variances.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sigma_s, <span class="at">y=</span>position, <span class="at">color=</span>posterior)) <span class="sc">+</span> </span>
<span id="cb24-10"><a href="equal-variances.html#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">7</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-11"><a href="equal-variances.html#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="equal-variances.html#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb24-13"><a href="equal-variances.html#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() </span></code></pre></div>
<div class="figure"><span id="fig:fig-sigmas-and-contraction"></span>
<img src="bayesception_files/figure-html/fig-sigmas-and-contraction-1.png" alt="stronger contraction for lower precision" width="672" />
<p class="caption">
Figure 2.4: stronger contraction for lower precision
</p>
</div>
</div>
<div id="the-stronger-the-low-velocity-prior-the-stronger-the-length-contraction" class="section level3" number="2.8.5">
<h3><span class="header-section-number">2.8.5</span> The stronger the low-velocity prior, the stronger the length contraction</h3>
<p>Finally, the low-velocity prior is varied as the only parameter.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="equal-variances.html#cb25-1" aria-hidden="true" tabindex="-1"></a>modelData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1m=</span><span class="dv">3</span>, <span class="at">x2m=</span><span class="dv">7</span>, <span class="at">sigma_s=</span><span class="dv">1</span>, <span class="at">sigma_v=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out=</span><span class="dv">21</span>), <span class="at">time_t=</span><span class="fl">0.15</span>)</span>
<span id="cb25-2"><a href="equal-variances.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="equal-variances.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute posterior modes</span></span>
<span id="cb25-4"><a href="equal-variances.html#cb25-4" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x1 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x1_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb25-5"><a href="equal-variances.html#cb25-5" aria-hidden="true" tabindex="-1"></a>modelData<span class="sc">$</span>pm_x2 <span class="ot">&lt;-</span> <span class="fu">with</span>(modelData, <span class="fu">compute_x2_star</span>(x1m, x2m, sigma_s, sigma_v, time_t))</span>
<span id="cb25-6"><a href="equal-variances.html#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="equal-variances.html#cb25-7" aria-hidden="true" tabindex="-1"></a>modelData <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="equal-variances.html#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(pm_x1, pm_x2), <span class="at">names_to =</span> <span class="st">&quot;posterior&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;position&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-9"><a href="equal-variances.html#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sigma_v, <span class="at">y=</span>position, <span class="at">color=</span>posterior)) <span class="sc">+</span> </span>
<span id="cb25-10"><a href="equal-variances.html#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">7</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-11"><a href="equal-variances.html#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="equal-variances.html#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb25-13"><a href="equal-variances.html#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() </span></code></pre></div>
<div class="figure"><span id="fig:fig-sigmav-and-contraction"></span>
<img src="bayesception_files/figure-html/fig-sigmav-and-contraction-1.png" alt="stronger contraction for lower expected velocity" width="672" />
<p class="caption">
Figure 2.5: stronger contraction for lower expected velocity
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
